import"./chunk-6ZRW4NQ5.js";import{a as _e}from"./chunk-VQLAA2B3.js";import{a as be}from"./chunk-NDAHUKLJ.js";import{a as N}from"./chunk-WCWF2U4M.js";import{a as Se}from"./chunk-JWWHVUZO.js";import{a as ne}from"./chunk-F6MBCUBG.js";import{b as ae,c as se,d as R,e as ce,f as de,g as me,h as y,j as ue,k as pe,l as he,o as ge,s as ve,w as fe,y as Ce}from"./chunk-NGUZVOSX.js";import{a as $,d as le}from"./chunk-GJJVJTXG.js";import"./chunk-CSO4ZWHK.js";import{A as J,C as Q,ba as K,ca as X,da as Z,ea as ee,fa as te,ga as ie,ha as re,ia as oe,u as Y,v as H,z as W}from"./chunk-IBYGZ3TV.js";import{Ga as b,Ia as m,Ma as k,N as M,Nb as q,Ob as z,Pb as B,Qb as O,Ta as l,Tb as G,Ua as n,V as f,Va as C,W as S,Wa as V,Xa as L,Za as P,ab as h,cb as g,cc as j,fc as U,nb as c,oa as d,ob as I,pa as _,pb as T,tb as F,ub as A,wb as D}from"./chunk-ICF7HI7T.js";import"./chunk-ENQRHBTS.js";var E=s=>({cursor:s}),De=s=>({border:s});function xe(s,u){s&1&&(l(0,"span",30),c(1," Display name is required"),n())}function Pe(s,u){s&1&&(l(0,"span",30),c(1," Role name is required"),n())}function Ne(s,u){if(s&1){let o=P();l(0,"div",12)(1,"c-card")(2,"c-card-header")(3,"h5"),c(4,"Roles Form"),n()(),l(5,"c-card-body")(6,"form",13)(7,"div",14)(8,"label",15),c(9,"Display Name"),n(),l(10,"div",16),C(11,"input",17),b(12,xe,2,0,"span",18),n(),l(13,"label",15),c(14,"Role Name"),n(),l(15,"div",16),C(16,"input",19),b(17,Pe,2,0,"span",18),n()(),l(18,"div",20)(19,"label",15),c(20,"Role Level"),n(),l(21,"div",16),C(22,"input",21),n(),l(23,"label",22),c(24,"Is Active"),n(),l(25,"div",16)(26,"div",23),C(27,"input",24),n()()(),l(28,"div",25)(29,"label",15),c(30,"Is Deletable"),n(),l(31,"div",16)(32,"div",26),C(33,"input",27),n()()()(),l(34,"button",28),h("click",function(){f(o);let a=g();return S(a.submit())}),c(35," Submit "),n(),l(36,"button",29),h("click",function(){f(o);let a=g();return S(a.cancel())}),c(37," Cancel "),n()()()()}if(s&2){let o=g();d(6),m("formGroup",o.roleData),d(5),m("ngStyle",D(8,De,o.roleData.controls.displayName.hasError("required")&&o.roleData.controls.displayName.touched?"2px solid red":"")),d(),m("ngIf",o.roleData.controls.displayName.hasError("required")&&o.roleData.controls.displayName.touched),d(4),m("ngStyle",D(10,De,o.roleData.controls.roleName.hasError("required")&&o.roleData.controls.roleName.touched?"2px solid red":"")),d(),m("ngIf",o.roleData.controls.roleName.hasError("required")&&o.roleData.controls.roleName.touched),d(17),m("disabled",o.roleData.invalid)("ngClass",o.roleData.invalid?"btn btn-danger submit":"btn btn-primary submit"),d(2),m("ngClass","btn btn-default")}}function Re(s,u){if(s&1){let o=P();V(0),l(1,"li",31)(2,"a",8),h("click",function(){let a=f(o).index,r=g();return S(r.currentPage===a+1?null:r.handlePagination(a+1))}),c(3),n()(),L()}if(s&2){let o=u.index,i=g();d(),m("active",i.currentPage===o+1)("ngStyle",D(3,E,i.currentPage===o+1?"":"pointer")),d(2),I(o+1)}}function Ee(s,u){if(s&1){let o=P();l(0,"div")(1,"c-modal",32,0),h("visibleChange",function(a){f(o);let r=g();return S(r.handleDeleteToggleChange(a))}),l(3,"c-modal-header")(4,"h5",33),c(5,"Delete Role "),l(6,"small"),c(7),n()(),l(8,"button",34),h("click",function(){f(o);let a=g();return S(a.closeDeleteModal())}),n()(),l(9,"c-modal-body"),c(10,"Are you sure you want to delete the role?"),n(),l(11,"c-modal-footer")(12,"button",35),h("click",function(){f(o);let a=g();return S(a.closeDeleteModal())}),c(13," Close "),n(),l(14,"button",36),h("click",function(){f(o);let a=g();return S(a.deleteRecord())}),c(15,"Delete"),n()()()()}if(s&2){let o=g();d(),m("@.disabled",!0)("visible",o.deleteModalVisible),d(6),T("(",o.deleteData==null?null:o.deleteData.displayName,")")}}var lt=(()=>{let u=class u{constructor(i,a,r,w,x,ye){this.toastrService=i,this.roleService=a,this.loaderService=r,this.utilService=w,this.route=x,this.localStorageService=ye,this.deleteModalVisible=!1,this.roleList=[],this.totalPages=1,this.currentPage=1,this.access=null,this.accessModule=null,this.accessSubModule=null,this.currentUserRole=this.utilService.getCurrentUserRole(),this.paramsubscriptions=[],this.context={componentParent:this},this.columnDefs=[],this.defaultColDef={filter:!0},this.rowSelection="multiple",this.paginationPageSize=10,this.paginationPageSizeSelector=[10,20,50],this.themeClass="ag-theme-quartz",this.closeDeleteModal=()=>{this.deleteData=null,this.deleteModalVisible=!this.deleteModalVisible},this.onPaginationChanged=t=>{console.log("onPaginationPageLoaded")},this.onGridReady=t=>{this.gridApi=t.api,this.getAll()},this.buildForm=t=>{this.roleData=new me({displayName:new y(t&&t.displayName?t.displayName:null,[R.required]),roleName:new y(t&&t.roleName?t.roleName:null,[R.required]),roleLevel:new y(t&&t.roleLevel?t.roleLevel:0),isActive:new y(t&&t.isActive?t.isActive:!1),isDeletable:new y(t&&t.isDeletable?t.isDeletable:!1)})},this.editRole=t=>{this.editRoleData=t,this.buildForm(t)},this.handlePagination=t=>{this.currentPage=t,this.roleList=[],this.getAll()},this.getAll=()=>{let t=e=>{e&&e.success?(this.loaderService.hideLoader(),e.data&&e.data.length?(this.roleList=e.data,this.rowData=e.data,this.currentPage=e.currentPage,this.totalPages=e.totalPages):this.roleList=[]):(this.loaderService.hideLoader(),this.toastrService.showError("Error!",e.message))},v=e=>{this.loaderService.hideLoader(),this.toastrService.showError("Error!",e.error&&e.error?.errors?.msg?e.error.errors.msg:"Error while validating credentials.")};this.loaderService.showLoader(),this.roleService.getAll({pageQuery:this.currentPage,pageSize:this.paginationPageSize,roleType:"general"},t,v)},this.openModal=t=>{t.isActive?this.toastrService.showError("Error!","The Role is marked as active and cannot be deleted!"):this.roleData=t},this.cancel=()=>{this.editRoleData=null,this.roleData=null,this.buildForm()},this.deleteRecord=()=>{let t=e=>{e&&e.success?(this.toastrService.showSuccess("Success!",e.message),this.closeDeleteModal(),this.getAll()):this.toastrService.showError("Error!",e.message),this.loaderService.hideLoader()},v=e=>{this.loaderService.hideLoader(),this.toastrService.showError("Error!",e.error&&e.error?.errors?.msg?e.error.errors.msg:"Error while deleting record.")};this.loaderService.showLoader(),this.roleService.deleteById({rolesId:this.deleteData.rolesId},t,v)},this.submit=()=>{let t=e=>{e&&e.success?(this.toastrService.showSuccess("Success!",e.message),this.loaderService.hideLoader(),this.cancel(),this.getAll()):(this.loaderService.hideLoader(),this.toastrService.showError("Error!",e&&e?.message?e?.message:"Error while saving role record."))},v=e=>{this.loaderService.hideLoader(),this.toastrService.showError("Error!",e.error&&e.error?.errors?.msg?e.error.errors.msg:"Error while saving role record.")};this.loaderService.showLoader(),this.editRoleData?.rolesId?(this.roleData.value.rolesId=this.editRoleData.rolesId,this.roleService.update(this.roleData.value,t,v)):this.roleService.add(this.roleData.value,t,v)},this.liveDemoVisible=!1;let we=this.route.data.subscribe(t=>{if(this.accessModule=t.module,this.accessSubModule=t.subModule,this.accessModule){let v=this.localStorageService.getValue("user")?.permissions?JSON.parse(this.localStorageService.getValue("user").permissions):Se.permissionList;if(v&&v.length){let e=v.filter(p=>p.key===this.accessModule)[0];e&&e.submodule&&e.submodule.length?this.access=e.submodule.filter(p=>p.key===this.accessSubModule)[0].access:this.access=e.access,this.access=this.access[this.currentUserRole],this.access&&this.access.view?(this.columnDefs=[{headerName:"#",filter:!1,sortable:!1,valueFormatter:p=>`${p.node.data.rolesId}`,suppressMovable:!0},{headerName:"Role Name",field:"displayName",suppressMovable:!0},{headerName:"Role Level",field:"roleLevel",suppressMovable:!0},{headerName:"Is Active?",filter:!1,sortable:!1,valueFormatter:p=>`${p.node.data.isActive?"Yes":"No"}`,suppressMovable:!0},{headerName:"Is Deletable?",filter:!1,sortable:!1,valueFormatter:p=>`${p.node.data.isDeletable?"Yes":"No"}`,suppressMovable:!0}],this.access.edit&&this.columnDefs.push({headerName:"Action",filter:!1,sortable:!1,valueFormatter:p=>`${p.node.data}`,cellRenderer:_e,cellRendererParams:{specificId:"roleButtons",onClick:this.onButtonClick.bind(this)}}),this.getAll()):(this.toastrService.showWarning("Warning!","You donot have permission to view this page. Please contact to administrator!"),this.utilService.goto("/dashboard"))}}});this.paramsubscriptions.push(we)}ngOnInit(){this.buildForm()}onButtonClick(i,a){a==="update"?this.editRole(i):this.toggleDeleteModal(i)}ngOnDestroy(){try{if(this.paramsubscriptions)for(let i=0;i<this.paramsubscriptions.length;i++)this.paramsubscriptions[i].unsubscribe()}catch(i){console.error(i)}try{this.params&&this.params.unsubscribe()}catch(i){console.error(i)}}toggleDeleteModal(i){this.deleteData=i,this.deleteModalVisible=!this.deleteModalVisible}handleDeleteToggleChange(i){this.deleteModalVisible=i}numSequence(i){return Array(i)}toggleLiveDemo(){this.liveDemoVisible=!this.liveDemoVisible}handleLiveDemoChange(i){this.liveDemoVisible=i}};u.\u0275fac=function(a){return new(a||u)(_(Ce),_(N),_($),_(ne),_(j),_(le))},u.\u0275cmp=M({type:u,selectors:[["ng-component"]],standalone:!0,features:[F([N]),A],decls:15,vars:23,consts:[["staticBackdropModal",""],["style","margin-bottom: 10px;",4,"ngIf"],[1,"example-wrapper"],[1,"example-header"],[2,"margin-top","6px"],[2,"float","right"],["align","end","size","sm"],["cPageItem","",3,"disabled","ngStyle"],["cPageLink","",3,"click","routerLink"],[4,"ngFor","ngForOf"],[2,"width","100%","height","300px",3,"paginationChanged","gridReady","columnDefs","defaultColDef","rowSelection","paginationPageSize","paginationPageSizeSelector","pagination","suppressPaginationPanel","suppressScrollOnNewData","rowData","context"],[4,"ngIf"],[2,"margin-bottom","10px"],[3,"formGroup"],[1,"form-group","row","mb-3"],[1,"col-md-2","col-form-label"],[1,"col-md-4"],["type","text","formControlName","displayName","id","displayName","placeholder","eg: Admin / Super","required","",1,"form-control",3,"ngStyle"],["style","color: red",4,"ngIf"],["type","text","formControlName","roleName","id","roleName","placeholder","eg: admin / super","required","",1,"form-control",3,"ngStyle"],[1,"form-group","row"],["type","number","formControlName","roleLevel","id","roleLevel","placeholder","Role Level",1,"form-control"],[1,"col-md-2","form-check-label","col-form-label"],[1,"form-check","form-switch"],["type","checkbox","id","isActive","formControlName","isActive",1,"form-check-input"],[1,"form-group","row","mt-3"],[1,"form-switch"],["formControlName","isDeletable","type","checkbox","role","switch","id","isDeletable",1,"form-check-input","form-control"],[3,"click","disabled","ngClass"],[3,"click","ngClass"],[2,"color","red"],["cPageItem","",3,"active","ngStyle"],["backdrop","static","id","staticBackdropModal",3,"visibleChange","visible"],["cModalTitle",""],["cButtonClose","",3,"click"],["cButton","","color","secondary",3,"click"],["cButton","","color","danger",3,"click"]],template:function(a,r){a&1&&(b(0,Ne,38,12,"div",1),l(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"c-pagination",6)(6,"li",7)(7,"a",8),h("click",function(){return r.handlePagination(r.currentPage-1)}),c(8,"Previous"),n()(),b(9,Re,4,5,"ng-container",9),l(10,"li",7)(11,"a",8),h("click",function(){return r.handlePagination(r.currentPage+1)}),c(12,"Next"),n()()()()()(),l(13,"ag-grid-angular",10),h("paginationChanged",function(x){return r.onPaginationChanged(x)})("gridReady",function(x){return r.onGridReady(x)}),n()(),b(14,Ee,16,3,"div",11)),a&2&&(m("ngIf",r.access==null?null:r.access.add),d(6),m("disabled",r.currentPage===1)("ngStyle",D(19,E,r.currentPage===1?"":"pointer")),d(3),m("ngForOf",r.numSequence(r.totalPages)),d(),m("disabled",r.currentPage===r.totalPages)("ngStyle",D(21,E,r.currentPage===r.totalPages?"":"pointer")),d(3),k(r.themeClass),m("columnDefs",r.columnDefs)("defaultColDef",r.defaultColDef)("rowSelection",r.rowSelection)("paginationPageSize",r.paginationPageSize)("paginationPageSizeSelector",r.paginationPageSizeSelector)("pagination",!0)("suppressPaginationPanel",!0)("suppressScrollOnNewData",!0)("rowData",r.rowData)("context",r.context),d(),m("ngIf",r.deleteModalVisible))},dependencies:[oe,be,re,ie,U,te,Z,ee,H,K,X,W,Q,J,Y,fe,ue,se,pe,ae,ce,de,ve,he,ge,O,G,q,z,B],styles:[".example-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}#myGrid[_ngcontent-%COMP%]{flex:1 1 0px;width:100%}.example-header[_ngcontent-%COMP%]{font-family:Verdana,Geneva,Tahoma,sans-serif;font-size:13px;margin-bottom:5px}.value[_ngcontent-%COMP%]{margin-right:20px;font-weight:700;width:50px;display:inline-block;text-align:right;padding-right:2px}"]});let s=u;return s})();export{lt as RolesComponent};
