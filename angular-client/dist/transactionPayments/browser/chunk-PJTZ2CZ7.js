import{b as d,d as h,e as g,g as u}from"./chunk-GJJVJTXG.js";import{I as l,L as c,Wb as p}from"./chunk-ICF7HI7T.js";var n=class extends Error{};n.prototype.name="InvalidTokenError";function m(i){return decodeURIComponent(atob(i).replace(/(.)/g,(t,a)=>{let e=a.charCodeAt(0).toString(16).toUpperCase();return e.length<2&&(e="0"+e),"%"+e}))}function v(i){let t=i.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return m(t)}catch{return atob(t)}}function f(i,t){if(typeof i!="string")throw new n("Invalid token specified: must be a string");t||(t={});let a=t.header===!0?0:1,e=i.split(".")[a];if(typeof e!="string")throw new n(`Invalid token specified: missing part #${a+1}`);let r;try{r=v(e)}catch(o){throw new n(`Invalid token specified: invalid base64 for part #${a+1} (${o.message})`)}try{return JSON.parse(r)}catch(o){throw new n(`Invalid token specified: invalid json for part #${a+1} (${o.message})`)}}var D=(()=>{let t=class t{constructor(e,r,o){this.delegatorService=e,this.httpErrorHandler=r,this.localStorageService=o,this.apiUrl=`${d.apiUrl}`,this.httpOptions={headers:new p({"Content-Type":"application/json"})},this.handleError=this.httpErrorHandler.createHandleError("AuthService")}register(e,r,o){let s=this.apiUrl+"/register";return this.delegatorService.post(e,s,null,r,o)}resetPassword(e,r,o){let s=this.apiUrl+"/reset-password";return this.delegatorService.post(e,s,null,r,o)}login(e,r,o){let s=this.apiUrl+"/login";return this.delegatorService.post(e,s,null,r,o)}doLogin(e){this.localStorageService.setValue("user",e)}getCurrentUser(){return this.localStorageService.getValue("user")}getDecodeToken(e){return f(e)}isLoggedIn(){if(this.getCurrentUser()){let r=this.getDecodeToken(this.localStorageService.getValue("accessToken")),o=Math.round(new Date().getTime()/1e3);if(r.exp&&r.exp>o)return!0;this.logout()}return!1}logout(){this.localStorageService.clearAllLocalStorage()}};t.\u0275fac=function(r){return new(r||t)(c(g),c(u),c(h))},t.\u0275prov=l({token:t,factory:t.\u0275fac,providedIn:"root"});let i=t;return i})();export{D as a};
